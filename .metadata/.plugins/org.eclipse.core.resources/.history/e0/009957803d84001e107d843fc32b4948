package packagee11_Stacks;

import java.util.Stack;

public class P3_Decode_a_String {
	
	public static String decode(String str) {
		
		Stack<Object> st = new Stack<>();
		
		for(char c: str.toCharArray()) {
			
			if(c != ']') {
				st.push(c);
			}else {
				
				String currVal = "";
				while(!st.isEmpty() && st.peek() instanceof Character && (char)  st.peek() != '[') {
					currVal =  st.pop()+currVal;
				}
				st.pop();
				
				// find the number
				StringBuilder number = new StringBuilder();
				while(!st.isEmpty() && st.peek() instanceof Character &&  Character.isDigit((char)  st.peek() )) {
					number.append(st.pop());
				}
				
				Integer count = Integer.parseInt(number.toString());
				StringBuilder currValrepeated = new StringBuilder("");
				for(int i=0;i<count;i++) {
					currValrepeated.append(currVal);
				}
				
				st.push(currValrepeated.toString());
			}
			
		}
		
		StringBuilder result = new StringBuilder("");
		for(Object obj : st) {
			
			if(obj instanceof Character) {
				result.append((char) obj);
			}else if(obj instanceof String) {
				result.append((String) obj);
			}
			
		}
		
		return result.toString();
	}

	public static void main(String[] args) {
		
		String encodedStr = "3[ab2[cv]]";
		
		String decodedStr = decode(encodedStr);
		
		System.out.println(decodedStr);

	}

}
